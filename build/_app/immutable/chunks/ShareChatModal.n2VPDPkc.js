import{b as te,o as qe,U as Ge,q as Je,r as ke,v as de,i as he,w as pe,x as Ze,m as Ye,d as xe}from"./index.D2mQNFJF.js";import{s as le,y as ae,z as se,a as B,d as c,f,i as $,g,n as ue,B as je,E as Le,j as J,p as Ue,G as Ne,r as Oe,k as L,o as U,v as De,w as Ve,x as ze,e as I,t as O,l as ye,c as M,A as ee,b as D,u as Z,h as V,F as He,q as Fe}from"./scheduler.Dz-NSSWT.js";import{S as ne,i as re,f as Pe,b as Y,d as x,m as F,t as H,a as R,e as K,g as Re,c as We}from"./index.CVQtJBk6.js";import{T as Ke}from"./create.BSJgY7P6.js";import{M as Qe,a as Xe,b as et}from"./menu-trigger.BEfW-VTh.js";import{g as Te}from"./entry.BULDOmPt.js";import{f as tt}from"./index.B19UeGvj.js";import{b as at,c as st,u as Ce,d as Ee,e as ce,f as lt,h as nt,i as me,s as rt,j as ot}from"./index.BNHNJEox.js";import{T as it}from"./Tags.rNughajE.js";import{t as Se}from"./Toaster.svelte_svelte_type_style_lang.Bxfrv8ue.js";import{h as ct}from"./index.C8OzP8zI.js";import{M as ut}from"./Modal.Cx3fPC8l.js";const Jt=async l=>{let e=null;const a=await fetch(`${te}/memories/`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).catch(t=>(e=t.detail,console.log(t),null));if(e)throw e;return a},Zt=async(l,e)=>{let a=null;const t=await fetch(`${te}/memories/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s.detail,console.log(s),null));if(a)throw a;return t},Yt=async(l,e,a)=>{let t=null;const s=await fetch(`${te}/memories/${e}/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({content:a})}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(t=n.detail,console.log(n),null));if(t)throw t;return s},xt=async(l,e)=>{let a=null;const t=await fetch(`${te}/memories/query`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s.detail,console.log(s),null));if(a)throw a;return t},Ft=async(l,e)=>{let a=null;const t=await fetch(`${te}/memories/${e}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).then(s=>s).catch(s=>(a=s.detail,console.log(s),null));if(a)throw a;return t},Kt=async l=>{let e=null;const a=await fetch(`${te}/memories/delete/user`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${l}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).then(t=>t).catch(t=>(e=t.detail,console.log(t),null));if(e)throw e;return a};function ft(l){let e,a;return{c(){e=ae("svg"),a=ae("path"),this.h()},l(t){e=se(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=B(e);a=se(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),B(a).forEach(c),s.forEach(c),this.h()},h(){f(a,"stroke-linecap","round"),f(a,"stroke-linejoin","round"),f(a,"d","m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width",l[1]),f(e,"stroke","currentColor"),f(e,"class",l[0])},m(t,s){$(t,e,s),g(e,a)},p(t,[s]){s&2&&f(e,"stroke-width",t[1]),s&1&&f(e,"class",t[0])},i:ue,o:ue,d(t){t&&c(e)}}}function dt(l,e,a){let{className:t="size-3.5"}=e,{strokeWidth:s="2.5"}=e;return l.$$set=n=>{"className"in n&&a(0,t=n.className),"strokeWidth"in n&&a(1,s=n.strokeWidth)},[t,s]}class ht extends ne{constructor(e){super(),re(this,e,dt,ft,le,{className:0,strokeWidth:1})}}const pt=l=>({}),Ie=l=>({});function mt(l){let e;const a=l[8].default,t=Oe(a,l,l[17],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,n){t&&t.m(s,n),e=!0},p(s,n){t&&t.p&&(!e||n&131072)&&De(t,a,s,s[17],e?ze(a,s[17],n,null):Ve(s[17]),null)},i(s){e||(H(t,s),e=!0)},o(s){R(t,s),e=!1},d(s){t&&t.d(s)}}}function Me(l){let e,a,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.25 9.75 16.5 12l-2.25 2.25m-4.5 0L7.5 12l2.25-2.25M6 20.25h12A2.25 2.25 0 0 0 20.25 18V6A2.25 2.25 0 0 0 18 3.75H6A2.25 2.25 0 0 0 3.75 6v12A2.25 2.25 0 0 0 6 20.25Z"></path></svg>',s,n,r=l[3].t("Playground")+"",o,i,u,w,y='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',h,d,_=l[3].t("Admin Panel")+"",T,E,k;return{c(){e=I("button"),a=I("div"),a.innerHTML=t,s=L(),n=I("div"),o=O(r),i=L(),u=I("button"),w=I("div"),w.innerHTML=y,h=L(),d=I("div"),T=O(_),this.h()},l(A){e=M(A,"BUTTON",{class:!0});var p=B(e);a=M(p,"DIV",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-4ehrk0"&&(a.innerHTML=t),s=U(p),n=M(p,"DIV",{class:!0});var S=B(n);o=D(S,r),S.forEach(c),p.forEach(c),i=U(A),u=M(A,"BUTTON",{class:!0});var v=B(u);w=M(v,"DIV",{class:!0,"data-svelte-h":!0}),ee(w)!=="svelte-1vodyax"&&(w.innerHTML=y),h=U(v),d=M(v,"DIV",{class:!0});var m=B(d);T=D(m,_),m.forEach(c),v.forEach(c),this.h()},h(){f(a,"class","self-center mr-3"),f(n,"class","self-center font-medium"),f(e,"class","flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"),f(w,"class","self-center mr-3"),f(d,"class","self-center font-medium"),f(u,"class","flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition")},m(A,p){$(A,e,p),g(e,a),g(e,s),g(e,n),g(n,o),$(A,i,p),$(A,u,p),g(u,w),g(u,h),g(u,d),g(d,T),E||(k=[Z(e,"click",l[11]),Z(u,"click",l[12])],E=!0)},p(A,p){p&8&&r!==(r=A[3].t("Playground")+"")&&V(o,r),p&8&&_!==(_=A[3].t("Admin Panel")+"")&&V(T,_)},d(A){A&&(c(e),c(i),c(u)),E=!1,He(k)}}}function Be(l){let e,a,t,s;return t=new Ke({props:{content:l[5]&&l[5].length>0?`${l[3].t("Running")}: ${l[5].join(", ")} ✨`:"",$$slots:{default:[gt]},$$scope:{ctx:l}}}),{c(){e=I("hr"),a=L(),Y(t.$$.fragment),this.h()},l(n){e=M(n,"HR",{class:!0}),a=U(n),x(t.$$.fragment,n),this.h()},h(){f(e,"class","dark:border-gray-800 my-1.5 p-0")},m(n,r){$(n,e,r),$(n,a,r),F(t,n,r),s=!0},p(n,r){const o={};r&40&&(o.content=n[5]&&n[5].length>0?`${n[3].t("Running")}: ${n[5].join(", ")} ✨`:""),r&131096&&(o.$$scope={dirty:r,ctx:n}),t.$set(o)},i(n){s||(H(t.$$.fragment,n),s=!0)},o(n){R(t.$$.fragment,n),s=!1},d(n){n&&(c(e),c(a)),K(t,n)}}}function gt(l){let e,a,t='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-green-500"></span></span>',s,n,r,o=l[3].t("Active Users")+"",i,u,w,y,h;return{c(){e=I("div"),a=I("div"),a.innerHTML=t,s=L(),n=I("div"),r=I("span"),i=O(o),u=O(":"),w=L(),y=I("span"),h=O(l[4]),this.h()},l(d){e=M(d,"DIV",{class:!0});var _=B(e);a=M(_,"DIV",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-dl2p8d"&&(a.innerHTML=t),s=U(_),n=M(_,"DIV",{class:!0});var T=B(n);r=M(T,"SPAN",{class:!0});var E=B(r);i=D(E,o),u=D(E,":"),E.forEach(c),w=U(T),y=M(T,"SPAN",{class:!0});var k=B(y);h=D(k,l[4]),k.forEach(c),T.forEach(c),_.forEach(c),this.h()},h(){f(a,"class","flex items-center"),f(r,"class","font-medium"),f(y,"class","font-semibold"),f(n,"class",""),f(e,"class","flex rounded-md py-1.5 px-3 text-xs gap-2.5 items-center")},m(d,_){$(d,e,_),g(e,a),g(e,s),g(e,n),g(n,r),g(r,i),g(r,u),g(n,w),g(n,y),g(y,h)},p(d,_){_&8&&o!==(o=d[3].t("Active Users")+"")&&V(i,o),_&16&&V(h,d[4])},d(d){d&&c(e)}}}function _t(l){let e,a,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',s,n,r=l[3].t("Settings")+"",o,i,u,w,y,h,d,_=l[3].t("Archived Chats")+"",T,E,k,A,p,S,v,m='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M3 4.25A2.25 2.25 0 015.25 2h5.5A2.25 2.25 0 0113 4.25v2a.75.75 0 01-1.5 0v-2a.75.75 0 00-.75-.75h-5.5a.75.75 0 00-.75.75v11.5c0 .414.336.75.75.75h5.5a.75.75 0 00.75-.75v-2a.75.75 0 011.5 0v2A2.25 2.25 0 0110.75 18h-5.5A2.25 2.25 0 013 15.75V4.25z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6 10a.75.75 0 01.75-.75h9.546l-1.048-.943a.75.75 0 111.004-1.114l2.5 2.25a.75.75 0 010 1.114l-2.5 2.25a.75.75 0 11-1.004-1.114l1.048-.943H6.75A.75.75 0 016 10z" clip-rule="evenodd"></path></svg>',C,P,W=l[3].t("Sign Out")+"",Q,G,q,X,fe,ge;y=new ht({props:{className:"size-5",strokeWidth:"1.5"}});let z=l[1]==="admin"&&Me(l),N=l[4]&&Be(l);return{c(){e=I("button"),a=I("div"),a.innerHTML=t,s=L(),n=I("div"),o=O(r),i=L(),u=I("button"),w=I("div"),Y(y.$$.fragment),h=L(),d=I("div"),T=O(_),E=L(),z&&z.c(),k=L(),A=I("hr"),p=L(),S=I("button"),v=I("div"),v.innerHTML=m,C=L(),P=I("div"),Q=O(W),G=L(),N&&N.c(),q=ye(),this.h()},l(b){e=M(b,"BUTTON",{class:!0});var j=B(e);a=M(j,"DIV",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-1ew1v3e"&&(a.innerHTML=t),s=U(j),n=M(j,"DIV",{class:!0});var _e=B(n);o=D(_e,r),_e.forEach(c),j.forEach(c),i=U(b),u=M(b,"BUTTON",{class:!0});var oe=B(u);w=M(oe,"DIV",{class:!0});var ve=B(w);x(y.$$.fragment,ve),ve.forEach(c),h=U(oe),d=M(oe,"DIV",{class:!0});var we=B(d);T=D(we,_),we.forEach(c),oe.forEach(c),E=U(b),z&&z.l(b),k=U(b),A=M(b,"HR",{class:!0}),p=U(b),S=M(b,"BUTTON",{class:!0});var ie=B(S);v=M(ie,"DIV",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-1svlfdm"&&(v.innerHTML=m),C=U(ie),P=M(ie,"DIV",{class:!0});var be=B(P);Q=D(be,W),be.forEach(c),ie.forEach(c),G=U(b),N&&N.l(b),q=ye(),this.h()},h(){f(a,"class","self-center mr-3"),f(n,"class","self-center font-medium"),f(e,"class","flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"),f(w,"class","self-center mr-3"),f(d,"class","self-center font-medium"),f(u,"class","flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"),f(A,"class","dark:border-gray-800 my-1.5 p-0"),f(v,"class","self-center mr-3"),f(P,"class","self-center font-medium"),f(S,"class","flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition")},m(b,j){$(b,e,j),g(e,a),g(e,s),g(e,n),g(n,o),$(b,i,j),$(b,u,j),g(u,w),F(y,w,null),g(u,h),g(u,d),g(d,T),$(b,E,j),z&&z.m(b,j),$(b,k,j),$(b,A,j),$(b,p,j),$(b,S,j),g(S,v),g(S,C),g(S,P),g(P,Q),$(b,G,j),N&&N.m(b,j),$(b,q,j),X=!0,fe||(ge=[Z(e,"click",l[9]),Z(u,"click",l[10]),Z(S,"click",l[13])],fe=!0)},p(b,j){(!X||j&8)&&r!==(r=b[3].t("Settings")+"")&&V(o,r),(!X||j&8)&&_!==(_=b[3].t("Archived Chats")+"")&&V(T,_),b[1]==="admin"?z?z.p(b,j):(z=Me(b),z.c(),z.m(k.parentNode,k)):z&&(z.d(1),z=null),(!X||j&8)&&W!==(W=b[3].t("Sign Out")+"")&&V(Q,W),b[4]?N?(N.p(b,j),j&16&&H(N,1)):(N=Be(b),N.c(),H(N,1),N.m(q.parentNode,q)):N&&(Re(),R(N,1,1,()=>{N=null}),We())},i(b){X||(H(y.$$.fragment,b),H(N),X=!0)},o(b){R(y.$$.fragment,b),R(N),X=!1},d(b){b&&(c(e),c(i),c(u),c(E),c(k),c(A),c(p),c(S),c(G),c(q)),K(y),z&&z.d(b),N&&N.d(b),fe=!1,He(ge)}}}function vt(l){let e,a;return e=new et({props:{class:"w-full "+l[2]+" text-sm rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow font-primary",sideOffset:8,side:"bottom",align:"start",transition:l[14],$$slots:{default:[_t]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,s){F(e,t,s),a=!0},p(t,s){const n={};s&4&&(n.class="w-full "+t[2]+" text-sm rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow font-primary"),s&131131&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){a||(H(e.$$.fragment,t),a=!0)},o(t){R(e.$$.fragment,t),a=!1},d(t){K(e,t)}}}function wt(l){let e,a,t;e=new Xe({props:{$$slots:{default:[mt]},$$scope:{ctx:l}}});const s=l[8].content,n=Oe(s,l,l[17],Ie),r=n||vt(l);return{c(){Y(e.$$.fragment),a=L(),r&&r.c()},l(o){x(e.$$.fragment,o),a=U(o),r&&r.l(o)},m(o,i){F(e,o,i),$(o,a,i),r&&r.m(o,i),t=!0},p(o,i){const u={};i&131072&&(u.$$scope={dirty:i,ctx:o}),e.$set(u),n?n.p&&(!t||i&131072)&&De(n,s,o,o[17],t?ze(s,o[17],i,pt):Ve(o[17]),Ie):r&&r.p&&(!t||i&63)&&r.p(o,t?i:-1)},i(o){t||(H(e.$$.fragment,o),H(r,o),t=!0)},o(o){R(e.$$.fragment,o),R(r,o),t=!1},d(o){o&&c(a),K(e,o),r&&r.d(o)}}}function bt(l){let e,a,t;function s(r){l[16](r)}let n={onOpenChange:l[15],$$slots:{default:[wt]},$$scope:{ctx:l}};return l[0]!==void 0&&(n.open=l[0]),e=new Qe({props:n}),je.push(()=>Pe(e,"open",s)),{c(){Y(e.$$.fragment)},l(r){x(e.$$.fragment,r)},m(r,o){F(e,r,o),t=!0},p(r,[o]){const i={};o&131135&&(i.$$scope={dirty:o,ctx:r}),!a&&o&1&&(a=!0,i.open=r[0],Le(()=>a=!1)),e.$set(i)},i(r){t||(H(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function kt(l,e,a){let t,s,n;J(l,qe,v=>a(4,s=v)),J(l,Ge,v=>a(5,n=v));let{$$slots:r={},$$scope:o}=e;const i=Ue("i18n");J(l,i,v=>a(3,t=v));let{show:u=!1}=e,{role:w=""}=e,{className:y="max-w-[240px]"}=e;const h=Ne(),d=async()=>{await Je.set(!0),a(0,u=!1)},_=()=>{h("show","archived-chat"),a(0,u=!1)},T=()=>{Te("/playground"),a(0,u=!1)},E=()=>{Te("/admin"),a(0,u=!1)},k=()=>{localStorage.removeItem("token"),location.href="/auth",a(0,u=!1)},A=v=>tt(v,{duration:100}),p=v=>{h("change",v)};function S(v){u=v,a(0,u)}return l.$$set=v=>{"show"in v&&a(0,u=v.show),"role"in v&&a(1,w=v.role),"className"in v&&a(2,y=v.className),"$$scope"in v&&a(17,o=v.$$scope)},[u,w,y,t,s,n,i,h,r,d,_,T,E,k,A,p,S,o]}class Qt extends ne{constructor(e){super(),re(this,e,kt,bt,le,{show:0,role:1,className:2})}}function yt(l){let e,a;return e=new it({props:{tags:l[0],deleteTag:l[2],addTag:l[1]}}),{c(){Y(e.$$.fragment)},l(t){x(e.$$.fragment,t)},m(t,s){F(e,t,s),a=!0},p(t,[s]){const n={};s&1&&(n.tags=t[0]),e.$set(n)},i(t){a||(H(e.$$.fragment,t),a=!0)},o(t){R(e.$$.fragment,t),a=!1},d(t){K(e,t)}}}function Tt(l,e,a){let t,s,n;J(l,ke,h=>a(4,t=h)),J(l,de,h=>a(5,s=h)),J(l,he,h=>a(6,n=h));const r=Ne();let{chatId:o=""}=e,i=[];const u=async()=>(await at(localStorage.token,o).catch(async h=>[])).filter(h=>h.name!=="pinned"),w=async h=>{await st(localStorage.token,o,h),a(0,i=await u()),await Ce(localStorage.token,o,{tags:i}),he.set(await Ee(localStorage.token)),await pe.set(await ce(localStorage.token,"pinned"))},y=async h=>{await lt(localStorage.token,o,h),a(0,i=await u()),await Ce(localStorage.token,o,{tags:i}),await he.set(await Ee(localStorage.token)),n.map(d=>d.name).includes(h)?(h==="pinned"?await pe.set(await ce(localStorage.token,"pinned")):await de.set(await ce(localStorage.token,h)),s.find(d=>d.id===o)&&r("close")):(ke.set(1),await de.set(await nt(localStorage.token,t)),await pe.set(await ce(localStorage.token,"pinned")),await Ze.set(!0))};return Fe(async()=>{o&&a(0,i=await u())}),l.$$set=h=>{"chatId"in h&&a(3,o=h.chatId)},[i,w,y,o]}class Xt extends ne{constructor(e){super(),re(this,e,Tt,yt,le,{chatId:3})}}function Ct(l){let e,a,t;return{c(){e=ae("svg"),a=ae("path"),t=ae("path"),this.h()},l(s){e=se(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var n=B(e);a=se(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),B(a).forEach(c),t=se(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),B(t).forEach(c),n.forEach(c),this.h()},h(){f(a,"fill-rule","evenodd"),f(a,"d","M8.914 6.025a.75.75 0 0 1 1.06 0 3.5 3.5 0 0 1 0 4.95l-2 2a3.5 3.5 0 0 1-5.396-4.402.75.75 0 0 1 1.251.827 2 2 0 0 0 3.085 2.514l2-2a2 2 0 0 0 0-2.828.75.75 0 0 1 0-1.06Z"),f(a,"clip-rule","evenodd"),f(t,"fill-rule","evenodd"),f(t,"d","M7.086 9.975a.75.75 0 0 1-1.06 0 3.5 3.5 0 0 1 0-4.95l2-2a3.5 3.5 0 0 1 5.396 4.402.75.75 0 0 1-1.251-.827 2 2 0 0 0-3.085-2.514l-2 2a2 2 0 0 0 0 2.828.75.75 0 0 1 0 1.06Z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16"),f(e,"fill","currentColor"),f(e,"class",l[0])},m(s,n){$(s,e,n),g(e,a),g(e,t)},p(s,[n]){n&1&&f(e,"class",s[0])},i:ue,o:ue,d(s){s&&c(e)}}}function Et(l,e,a){let{className:t="w-4 h-4"}=e;return l.$$set=s=>{"className"in s&&a(0,t=s.className)},[t]}class St extends ne{constructor(e){super(),re(this,e,Et,Ct,le,{className:0})}}function $e(l){var v;let e,a,t,s,n,r,o,i,u,w,y,h,d;function _(m,C){return m[2].share_id?Mt:It}let T=_(l),E=T(l),k=((v=l[4])==null?void 0:v.features.enable_community_sharing)&&Ae(l);u=new St({});function A(m,C){return m[2].share_id?$t:Bt}let p=A(l),S=p(l);return{c(){e=I("div"),a=I("div"),E.c(),t=L(),s=I("div"),n=I("div"),r=I("div"),k&&k.c(),o=L(),i=I("button"),Y(u.$$.fragment),w=L(),S.c(),this.h()},l(m){e=M(m,"DIV",{class:!0});var C=B(e);a=M(C,"DIV",{class:!0});var P=B(a);E.l(P),P.forEach(c),t=U(C),s=M(C,"DIV",{class:!0});var W=B(s);n=M(W,"DIV",{class:!0});var Q=B(n);r=M(Q,"DIV",{class:!0});var G=B(r);k&&k.l(G),o=U(G),i=M(G,"BUTTON",{class:!0,type:!0,id:!0});var q=B(i);x(u.$$.fragment,q),w=U(q),S.l(q),q.forEach(c),G.forEach(c),Q.forEach(c),W.forEach(c),C.forEach(c),this.h()},h(){f(a,"class","text-sm dark:text-gray-300 mb-1"),f(i,"class","self-center flex items-center gap-1 px-3.5 py-2 rounded-xl text-sm font-medium bg-emerald-600 hover:bg-emerald-500 text-white"),f(i,"type","button"),f(i,"id","copy-and-share-chat-button"),f(r,"class","flex gap-1"),f(n,"class","flex flex-col items-end space-x-1 mt-1.5"),f(s,"class","flex justify-end"),f(e,"class","px-5 pt-4 pb-5 w-full flex flex-col justify-center")},m(m,C){$(m,e,C),g(e,a),E.m(a,null),g(e,t),g(e,s),g(s,n),g(n,r),k&&k.m(r,null),g(r,o),g(r,i),F(u,i,null),g(i,w),S.m(i,null),y=!0,h||(d=Z(i,"click",l[11]),h=!0)},p(m,C){var P;T===(T=_(m))&&E?E.p(m,C):(E.d(1),E=T(m),E&&(E.c(),E.m(a,null))),(P=m[4])!=null&&P.features.enable_community_sharing?k?k.p(m,C):(k=Ae(m),k.c(),k.m(r,o)):k&&(k.d(1),k=null),p===(p=A(m))&&S?S.p(m,C):(S.d(1),S=p(m),S&&(S.c(),S.m(i,null)))},i(m){y||(H(u.$$.fragment,m),y=!0)},o(m){R(u.$$.fragment,m),y=!1},d(m){m&&c(e),E.d(),k&&k.d(),K(u),S.d(),h=!1,d()}}}function It(l){let e=l[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"",a;return{c(){a=O(e)},l(t){a=D(t,e)},m(t,s){$(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"")&&V(a,e)},d(t){t&&c(a)}}}function Mt(l){let e,a=l[3].t("You have shared this chat")+"",t,s,n,r=l[3].t("before")+"",o,i,u,w,y=l[3].t("Click here to")+"",h,d,_,T=l[3].t("delete this link")+"",E,k,A=l[3].t("and create a new shared link.")+"",p,S,v;return{c(){e=I("a"),t=O(a),s=L(),n=I("span"),o=O(r),i=O("."),w=L(),h=O(y),d=L(),_=I("button"),E=O(T),k=L(),p=O(A),this.h()},l(m){e=M(m,"A",{href:!0,target:!0});var C=B(e);t=D(C,a),s=U(C),n=M(C,"SPAN",{class:!0});var P=B(n);o=D(P,r),P.forEach(c),i=D(C,"."),C.forEach(c),w=U(m),h=D(m,y),d=U(m),_=M(m,"BUTTON",{class:!0});var W=B(_);E=D(W,T),W.forEach(c),k=U(m),p=D(m,A),this.h()},h(){f(n,"class","underline"),f(e,"href",u="/s/"+l[2].share_id),f(e,"target","_blank"),f(_,"class","underline")},m(m,C){$(m,e,C),g(e,t),g(e,s),g(e,n),g(n,o),g(e,i),$(m,w,C),$(m,h,C),$(m,d,C),$(m,_,C),g(_,E),$(m,k,C),$(m,p,C),S||(v=Z(_,"click",l[9]),S=!0)},p(m,C){C&8&&a!==(a=m[3].t("You have shared this chat")+"")&&V(t,a),C&8&&r!==(r=m[3].t("before")+"")&&V(o,r),C&4&&u!==(u="/s/"+m[2].share_id)&&f(e,"href",u),C&8&&y!==(y=m[3].t("Click here to")+"")&&V(h,y),C&8&&T!==(T=m[3].t("delete this link")+"")&&V(E,T),C&8&&A!==(A=m[3].t("and create a new shared link.")+"")&&V(p,A)},d(m){m&&(c(e),c(w),c(h),c(d),c(_),c(k),c(p)),S=!1,v()}}}function Ae(l){let e,a=l[3].t("Share to OpenWebUI Community")+"",t,s,n;return{c(){e=I("button"),t=O(a),this.h()},l(r){e=M(r,"BUTTON",{class:!0,type:!0});var o=B(e);t=D(o,a),o.forEach(c),this.h()},h(){f(e,"class","self-center px-3.5 py-2 rounded-xl text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-white"),f(e,"type","button")},m(r,o){$(r,e,o),g(e,t),s||(n=Z(e,"click",l[10]),s=!0)},p(r,o){o&8&&a!==(a=r[3].t("Share to OpenWebUI Community")+"")&&V(t,a)},d(r){r&&c(e),s=!1,n()}}}function Bt(l){let e=l[3].t("Copy Link")+"",a;return{c(){a=O(e)},l(t){a=D(t,e)},m(t,s){$(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Copy Link")+"")&&V(a,e)},d(t){t&&c(a)}}}function $t(l){let e=l[3].t("Update and Copy Link")+"",a;return{c(){a=O(e)},l(t){a=D(t,e)},m(t,s){$(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Update and Copy Link")+"")&&V(a,e)},d(t){t&&c(a)}}}function At(l){let e,a,t,s=l[3].t("Share Chat")+"",n,r,o,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',u,w,y,h,d=l[2]&&$e(l);return{c(){e=I("div"),a=I("div"),t=I("div"),n=O(s),r=L(),o=I("button"),o.innerHTML=i,u=L(),d&&d.c(),this.h()},l(_){e=M(_,"DIV",{});var T=B(e);a=M(T,"DIV",{class:!0});var E=B(a);t=M(E,"DIV",{class:!0});var k=B(t);n=D(k,s),k.forEach(c),r=U(E),o=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(o)!=="svelte-745w2y"&&(o.innerHTML=i),E.forEach(c),u=U(T),d&&d.l(T),T.forEach(c),this.h()},h(){f(t,"class","text-lg font-medium self-center"),f(o,"class","self-center"),f(a,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(_,T){$(_,e,T),g(e,a),g(a,t),g(t,n),g(a,r),g(a,o),g(e,u),d&&d.m(e,null),w=!0,y||(h=Z(o,"click",l[8]),y=!0)},p(_,T){(!w||T&8)&&s!==(s=_[3].t("Share Chat")+"")&&V(n,s),_[2]?d?(d.p(_,T),T&4&&H(d,1)):(d=$e(_),d.c(),H(d,1),d.m(e,null)):d&&(Re(),R(d,1,1,()=>{d=null}),We())},i(_){w||(H(d),w=!0)},o(_){R(d),w=!1},d(_){_&&c(e),d&&d.d(),y=!1,h()}}}function jt(l){let e,a,t;function s(r){l[12](r)}let n={size:"sm",$$slots:{default:[At]},$$scope:{ctx:l}};return l[0]!==void 0&&(n.show=l[0]),e=new ut({props:n}),je.push(()=>Pe(e,"show",s)),{c(){Y(e.$$.fragment)},l(r){x(e.$$.fragment,r)},m(r,o){F(e,r,o),t=!0},p(r,[o]){const i={};o&65567&&(i.$$scope={dirty:o,ctx:r}),!a&&o&1&&(a=!0,i.show=r[0],Le(()=>a=!1)),e.$set(i)},i(r){t||(H(e.$$.fragment,r),t=!0)},o(r){R(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Lt(l,e,a){let t,s,n;J(l,Ye,p=>a(14,t=p)),J(l,xe,p=>a(4,n=p));let{chatId:r}=e,o=null,i=null;const u=Ue("i18n");J(l,u,p=>a(3,s=p));const w=async()=>{const p=await rt(localStorage.token,r);return i=`${window.location.origin}/s/${p.id}`,console.log(i),a(2,o=await me(localStorage.token,r)),i},y=async()=>{const p=o.chat;console.log("share",p),Se.success(s.t("Redirecting you to OpenWebUI Community"));const S="https://openwebui.com",v=await window.open(`${S}/chats/upload`,"_blank");window.addEventListener("message",m=>{m.origin===S&&m.data==="loaded"&&v.postMessage(JSON.stringify({chat:p,models:t.filter(C=>p.models.includes(C.id))}),"*")},!1)};let{show:h=!1}=e;const d=p=>o?p?o.id!==p.id||o.share_id!==p.share_id:!1:!0,_=()=>{a(0,h=!1)},T=async()=>{await ot(localStorage.token,r)&&a(2,o=await me(localStorage.token,r))},E=()=>{y(),a(0,h=!1)},k=async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){console.log("isSafari");const S=async()=>{const v=await w();return new Blob([v],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":S()})]).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(v=>(console.error("Async: Could not copy text: ",v),!1))}else ct(await w());Se.success(s.t("Copied shared chat URL to clipboard!")),a(0,h=!1)};function A(p){h=p,a(0,h)}return l.$$set=p=>{"chatId"in p&&a(1,r=p.chatId),"show"in p&&a(0,h=p.show)},l.$$.update=()=>{l.$$.dirty&7&&h&&(async()=>{if(r){const p=await me(localStorage.token,r);d(p)&&a(2,o=p)}else a(2,o=null),console.log(o)})()},[h,r,o,s,n,u,w,y,_,T,E,k,A]}class ea extends ne{constructor(e){super(),re(this,e,Lt,jt,le,{chatId:1,show:0})}}export{ht as A,ea as S,Xt as T,Qt as U,Zt as a,Kt as b,Ft as d,Jt as g,xt as q,Yt as u};
//# sourceMappingURL=ShareChatModal.n2VPDPkc.js.map
